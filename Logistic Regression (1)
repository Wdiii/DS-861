{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.model_selection import cross_val_score\n",
    "from sklearn.metrics import confusion_matrix\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>marital</th>\n",
       "      <th>education</th>\n",
       "      <th>default</th>\n",
       "      <th>balance</th>\n",
       "      <th>housing</th>\n",
       "      <th>loan</th>\n",
       "      <th>contact</th>\n",
       "      <th>duration</th>\n",
       "      <th>campaign</th>\n",
       "      <th>pdays</th>\n",
       "      <th>previous</th>\n",
       "      <th>poutcome</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>30</td>\n",
       "      <td>married</td>\n",
       "      <td>primary</td>\n",
       "      <td>no</td>\n",
       "      <td>1787</td>\n",
       "      <td>no</td>\n",
       "      <td>no</td>\n",
       "      <td>cellular</td>\n",
       "      <td>79</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>33</td>\n",
       "      <td>married</td>\n",
       "      <td>secondary</td>\n",
       "      <td>no</td>\n",
       "      <td>4789</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>cellular</td>\n",
       "      <td>220</td>\n",
       "      <td>1</td>\n",
       "      <td>339</td>\n",
       "      <td>4</td>\n",
       "      <td>failure</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>35</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>no</td>\n",
       "      <td>1350</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>cellular</td>\n",
       "      <td>185</td>\n",
       "      <td>1</td>\n",
       "      <td>330</td>\n",
       "      <td>1</td>\n",
       "      <td>failure</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>30</td>\n",
       "      <td>married</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>no</td>\n",
       "      <td>1476</td>\n",
       "      <td>yes</td>\n",
       "      <td>yes</td>\n",
       "      <td>unknown</td>\n",
       "      <td>199</td>\n",
       "      <td>4</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>59</td>\n",
       "      <td>married</td>\n",
       "      <td>secondary</td>\n",
       "      <td>no</td>\n",
       "      <td>0</td>\n",
       "      <td>yes</td>\n",
       "      <td>no</td>\n",
       "      <td>unknown</td>\n",
       "      <td>226</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>no</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   age  marital  education default  balance housing loan   contact  duration  \\\n",
       "0   30  married    primary      no     1787      no   no  cellular        79   \n",
       "1   33  married  secondary      no     4789     yes  yes  cellular       220   \n",
       "2   35   single   tertiary      no     1350     yes   no  cellular       185   \n",
       "3   30  married   tertiary      no     1476     yes  yes   unknown       199   \n",
       "4   59  married  secondary      no        0     yes   no   unknown       226   \n",
       "\n",
       "   campaign  pdays  previous poutcome   y  \n",
       "0         1     -1         0  unknown  no  \n",
       "1         1    339         4  failure  no  \n",
       "2         1    330         1  failure  no  \n",
       "3         4     -1         0  unknown  no  \n",
       "4         1     -1         0  unknown  no  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "BankData = pd.read_csv(\"bank.csv\")\n",
    "BankData.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['no' 'yes']\n"
     ]
    }
   ],
   "source": [
    "print(BankData['y'].unique()) #you can use unique if you would like to find out how many unique attributes each variable have"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "For dictionary of data please refer to https://archive.ics.uci.edu/ml/datasets/Bank+Marketing"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Our goal is to define a model best predicts outcome y - success of the marketing campaign "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "First let's create dummy variables for default, marital, housing, and loan"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   age  marital  education default  balance housing loan   contact  duration  \\\n",
      "0   30  married    primary      no     1787      no   no  cellular        79   \n",
      "1   33  married  secondary      no     4789     yes  yes  cellular       220   \n",
      "2   35   single   tertiary      no     1350     yes   no  cellular       185   \n",
      "3   30  married   tertiary      no     1476     yes  yes   unknown       199   \n",
      "4   59  married  secondary      no        0     yes   no   unknown       226   \n",
      "\n",
      "   campaign  pdays  previous poutcome   y  marital_single  default_yes  \\\n",
      "0         1     -1         0  unknown  no               0            0   \n",
      "1         1    339         4  failure  no               0            0   \n",
      "2         1    330         1  failure  no               1            0   \n",
      "3         4     -1         0  unknown  no               0            0   \n",
      "4         1     -1         0  unknown  no               0            0   \n",
      "\n",
      "   housing_yes  loan_yes  y_yes  \n",
      "0            0         0      0  \n",
      "1            1         1      0  \n",
      "2            1         0      0  \n",
      "3            1         1      0  \n",
      "4            1         0      0  \n",
      "               age       balance     duration     campaign        pdays  \\\n",
      "count  4521.000000   4521.000000  4521.000000  4521.000000  4521.000000   \n",
      "mean     41.170095   1422.657819   263.961292     2.793630    39.766645   \n",
      "std      10.576211   3009.638142   259.856633     3.109807   100.121124   \n",
      "min      19.000000  -3313.000000     4.000000     1.000000    -1.000000   \n",
      "25%      33.000000     69.000000   104.000000     1.000000    -1.000000   \n",
      "50%      39.000000    444.000000   185.000000     2.000000    -1.000000   \n",
      "75%      49.000000   1480.000000   329.000000     3.000000    -1.000000   \n",
      "max      87.000000  71188.000000  3025.000000    50.000000   871.000000   \n",
      "\n",
      "          previous  marital_single  default_yes  housing_yes     loan_yes  \\\n",
      "count  4521.000000     4521.000000  4521.000000  4521.000000  4521.000000   \n",
      "mean      0.542579        0.264543     0.016810     0.566025     0.152842   \n",
      "std       1.693562        0.441138     0.128575     0.495676     0.359875   \n",
      "min       0.000000        0.000000     0.000000     0.000000     0.000000   \n",
      "25%       0.000000        0.000000     0.000000     0.000000     0.000000   \n",
      "50%       0.000000        0.000000     0.000000     1.000000     0.000000   \n",
      "75%       0.000000        1.000000     0.000000     1.000000     0.000000   \n",
      "max      25.000000        1.000000     1.000000     1.000000     1.000000   \n",
      "\n",
      "             y_yes  \n",
      "count  4521.000000  \n",
      "mean      0.115240  \n",
      "std       0.319347  \n",
      "min       0.000000  \n",
      "25%       0.000000  \n",
      "50%       0.000000  \n",
      "75%       0.000000  \n",
      "max       1.000000  \n"
     ]
    }
   ],
   "source": [
    "Default_dummy  = pd.get_dummies(BankData['default'], prefix = 'default')\n",
    "del Default_dummy['default_no']\n",
    "\n",
    "marital_dummy  = pd.get_dummies(BankData['marital'], prefix = 'marital')\n",
    "del marital_dummy['marital_married']\n",
    "del marital_dummy['marital_divorced']\n",
    "\n",
    "housing_dummy  = pd.get_dummies(BankData['housing'], prefix = 'housing')\n",
    "del housing_dummy['housing_no']\n",
    "\n",
    "loan_dummy = pd.get_dummies(BankData['loan'], prefix = 'loan')\n",
    "del loan_dummy['loan_no']\n",
    "\n",
    "y_dummy = pd.get_dummies(BankData['y'], prefix = 'y')\n",
    "del y_dummy['y_no']\n",
    "\n",
    "\n",
    "\n",
    "BankData = pd.concat([BankData,marital_dummy , Default_dummy, housing_dummy, loan_dummy, y_dummy], axis=1)\n",
    "print(BankData.head())\n",
    "print(BankData.describe())\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "BankData['Intercept'] = 1\n",
    "X1 = BankData[['Intercept','age','balance','duration','campaign','previous','marital_single','default_yes','housing_yes','loan_yes']]\n",
    "y1 = BankData['y_yes']\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Task 1: run a logistic regression using statsmodels.api"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "logit = sm.Logit(y1, X1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Optimization terminated successfully.\n",
      "         Current function value: inf\n",
      "         Iterations 7\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\ProgramData\\Anaconda3\\lib\\site-packages\\statsmodels\\discrete\\discrete_model.py:1789: RuntimeWarning: divide by zero encountered in log\n",
      "  return np.sum(np.log(self.cdf(q*np.dot(X,params))))\n",
      "C:\\ProgramData\\Anaconda3\\lib\\site-packages\\statsmodels\\base\\model.py:492: HessianInversionWarning: Inverting hessian failed, no bse or cov_params available\n",
      "  'available', HessianInversionWarning)\n",
      "C:\\ProgramData\\Anaconda3\\lib\\site-packages\\statsmodels\\base\\model.py:492: HessianInversionWarning: Inverting hessian failed, no bse or cov_params available\n",
      "  'available', HessianInversionWarning)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"simpletable\">\n",
       "<caption>Logit Regression Results</caption>\n",
       "<tr>\n",
       "  <th>Dep. Variable:</th>         <td>y_yes</td>      <th>  No. Observations:  </th>  <td>  4521</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>  <td>  4511</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     9</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Date:</th>            <td>Wed, 08 Apr 2020</td> <th>  Pseudo R-squ.:     </th>  <td>   inf</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Time:</th>                <td>11:58:53</td>     <th>  Log-Likelihood:    </th> <td>    -inf</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td>  0.0000</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th>  <td> 1.000</td> \n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "         <td></td>           <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Intercept</th>      <td>   -3.2586</td> <td>    0.279</td> <td>  -11.695</td> <td> 0.000</td> <td>   -3.805</td> <td>   -2.712</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>age</th>            <td>    0.0101</td> <td>    0.005</td> <td>    1.905</td> <td> 0.057</td> <td>   -0.000</td> <td>    0.021</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>balance</th>        <td> 1.182e-05</td> <td> 1.58e-05</td> <td>    0.750</td> <td> 0.453</td> <td>-1.91e-05</td> <td> 4.27e-05</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>duration</th>       <td>    0.0038</td> <td>    0.000</td> <td>   20.782</td> <td> 0.000</td> <td>    0.003</td> <td>    0.004</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>campaign</th>       <td>   -0.0910</td> <td>    0.026</td> <td>   -3.488</td> <td> 0.000</td> <td>   -0.142</td> <td>   -0.040</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>previous</th>       <td>    0.1618</td> <td>    0.023</td> <td>    7.062</td> <td> 0.000</td> <td>    0.117</td> <td>    0.207</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>marital_single</th> <td>    0.3140</td> <td>    0.129</td> <td>    2.429</td> <td> 0.015</td> <td>    0.061</td> <td>    0.567</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>default_yes</th>    <td>    0.3459</td> <td>    0.412</td> <td>    0.841</td> <td> 0.401</td> <td>   -0.461</td> <td>    1.152</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>housing_yes</th>    <td>   -0.8404</td> <td>    0.111</td> <td>   -7.549</td> <td> 0.000</td> <td>   -1.059</td> <td>   -0.622</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>loan_yes</th>       <td>   -0.8483</td> <td>    0.185</td> <td>   -4.589</td> <td> 0.000</td> <td>   -1.211</td> <td>   -0.486</td>\n",
       "</tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<class 'statsmodels.iolib.summary.Summary'>\n",
       "\"\"\"\n",
       "                           Logit Regression Results                           \n",
       "==============================================================================\n",
       "Dep. Variable:                  y_yes   No. Observations:                 4521\n",
       "Model:                          Logit   Df Residuals:                     4511\n",
       "Method:                           MLE   Df Model:                            9\n",
       "Date:                Wed, 08 Apr 2020   Pseudo R-squ.:                     inf\n",
       "Time:                        11:58:53   Log-Likelihood:                   -inf\n",
       "converged:                       True   LL-Null:                        0.0000\n",
       "Covariance Type:            nonrobust   LLR p-value:                     1.000\n",
       "==================================================================================\n",
       "                     coef    std err          z      P>|z|      [0.025      0.975]\n",
       "----------------------------------------------------------------------------------\n",
       "Intercept         -3.2586      0.279    -11.695      0.000      -3.805      -2.712\n",
       "age                0.0101      0.005      1.905      0.057      -0.000       0.021\n",
       "balance         1.182e-05   1.58e-05      0.750      0.453   -1.91e-05    4.27e-05\n",
       "duration           0.0038      0.000     20.782      0.000       0.003       0.004\n",
       "campaign          -0.0910      0.026     -3.488      0.000      -0.142      -0.040\n",
       "previous           0.1618      0.023      7.062      0.000       0.117       0.207\n",
       "marital_single     0.3140      0.129      2.429      0.015       0.061       0.567\n",
       "default_yes        0.3459      0.412      0.841      0.401      -0.461       1.152\n",
       "housing_yes       -0.8404      0.111     -7.549      0.000      -1.059      -0.622\n",
       "loan_yes          -0.8483      0.185     -4.589      0.000      -1.211      -0.486\n",
       "==================================================================================\n",
       "\"\"\""
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "result = logit.fit()\n",
    "result.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Intercept         1.353409e-31\n",
      "age               5.675845e-02\n",
      "balance           4.530682e-01\n",
      "duration          6.264808e-96\n",
      "campaign          4.872088e-04\n",
      "previous          1.642332e-12\n",
      "marital_single    1.513585e-02\n",
      "default_yes       4.006123e-01\n",
      "housing_yes       4.399535e-14\n",
      "loan_yes          4.461870e-06\n",
      "dtype: float64\n",
      "Intercept        -3.258573\n",
      "age               0.010125\n",
      "balance           0.000012\n",
      "duration          0.003793\n",
      "campaign         -0.090990\n",
      "previous          0.161848\n",
      "marital_single    0.314041\n",
      "default_yes       0.345888\n",
      "housing_yes      -0.840408\n",
      "loan_yes         -0.848283\n",
      "dtype: float64\n"
     ]
    }
   ],
   "source": [
    "print(result.pvalues)\n",
    "print(result.params)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Task 2: Interpret Campaign, marital_single, housing_yes coefficients."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Answer: Campaign and housing_yes decrease odds of the output y. But marital_single has positive influence on odds. Keep all the variables same, 1 unit increase in Campaign may drop the odds by 9.09%; change from married to single will add the odds by 31.4%; change from housing no to yes will drop the odds by 84.04%. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Task3: What are your 10-fold cross-validation accuracy using sklearn library and solver = 'liblinear' and solver =  'newton-cg'? (Set max_iter = 50000 if you get a warning.) What do you learn?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "X = BankData[['age','balance','duration','campaign','previous','marital_single','default_yes','housing_yes','loan_yes']]\n",
    "y = BankData['y'] #This should be categorical - for statsmodels api that shall be 0 and 1 not necessarily '0' and '1'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[ 5.55591319e-03  1.08684041e-05  3.74562187e-03 -9.61584386e-02\n",
      "   1.58393639e-01  2.72176683e-01  1.65148669e-01 -8.70475337e-01\n",
      "  -8.22735777e-01]]\n",
      "[-2.99495866]\n",
      "0.8882997323643751\n"
     ]
    }
   ],
   "source": [
    "lm1 = LogisticRegression(solver = 'liblinear', max_iter = 50000)\n",
    "lm1.fit(X,y)\n",
    "print(lm1.coef_)\n",
    "print(lm1.intercept_)\n",
    "print(cross_val_score(lm1,X,y,cv=10, scoring = 'accuracy').mean())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[ 1.01764760e-02  1.19323934e-05  3.78719184e-03 -9.10647230e-02\n",
      "   1.61521388e-01  3.11420514e-01  2.92444526e-01 -8.30201697e-01\n",
      "  -8.19487650e-01]]\n",
      "[-3.26359854]\n",
      "0.8885204829162516\n"
     ]
    }
   ],
   "source": [
    "lm2 = LogisticRegression(solver = 'newton-cg', max_iter = 50000)\n",
    "lm2.fit(X,y)\n",
    "print(lm2.coef_)\n",
    "print(lm2.intercept_)\n",
    "print(cross_val_score(lm2,X,y,cv=10, scoring = 'accuracy').mean())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using different solver may get a different but similar result. In this case, the accuracy rate is high when we use 'newton-cg'."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Construct confusion matrices for logistic regression using solver = 'liblinear' and solver = 'newton-cg'."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[3928,   72],\n",
       "       [ 426,   95]], dtype=int64)"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_hat1 = lm1.predict(X)\n",
    "confusion_matrix(y, y_hat1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[3923,   77],\n",
       "       [ 427,   94]], dtype=int64)"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_hat2 = lm2.predict(X)\n",
    "confusion_matrix(y, y_hat2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### what did we learn from what we observerd in confusion matrices?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Answer: 3928/3923 is True/True prediction, 95/94 is False/False prediction, which is correct in this case. The incorrect part is 426/427, which is False but we predict it as True, and 72/77, which is True but we predict is as False. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### What is your prediction for a person who is 30 years old, 1000 dollars balance,  with duration = 210 , has been contacted 3 times for this campaign (campaign = 3),  who has previously been contacted 4 times, who is single, never defaulted, home owner and doesn't have any loan?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['no']\n",
      "[[0.90862424 0.09137576]]\n"
     ]
    }
   ],
   "source": [
    "x3 = [[30,1000,210,3,4,1,0,1,0]]\n",
    "print(lm2.predict(x3))  #It is more likely that y will be no.\n",
    "print(lm2.predict_proba(x3)) #the probility of y=no is 90.86%."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Now standardize your data - you can use standardization method used for KNN algorithms."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "def Standardize(X):\n",
    "    X_Max = X.max()\n",
    "    X_Min = X.min()\n",
    "    X_Standardized = (X-X_Min)/(X_Max - X_Min)\n",
    "    return X_Standardized\n",
    "\n",
    "BankData['age_SD'] = Standardize(BankData.age)\n",
    "BankData['balance_SD'] = Standardize(BankData.balance)\n",
    "BankData['duration_SD'] = Standardize(BankData.duration)\n",
    "BankData['campaign_SD'] = Standardize(BankData.campaign)\n",
    "BankData['previous_SD'] =  Standardize(BankData.previous)\n",
    "\n",
    "y = BankData['y'] \n",
    "X = BankData[['age_SD','balance_SD','duration_SD','campaign_SD','previous_SD',\n",
    "              'marital_single','default_yes','housing_yes','loan_yes']]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Use 10-fold cross validation to find the best tuning parameter - C. Use 'liblinear' and l1 penalty"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYAAAAD4CAYAAADlwTGnAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAgAElEQVR4nO3dfXRc9X3n8fdHkuVny3ZswI+xCS61gZMCqg8FkmYhJOA2oekurZ3DNiQ0NNnCNinbUzjJoZSe3bNp0552tyRdEp5K2xCXJFu3dSFsS3cbQhIMAVu2cTDGWCMZWyBZMpZsPX33j3tlD8NImrFGGln38zrHxzO/e+/c770azUf3d+9vriICMzPLnppqF2BmZtXhADAzyygHgJlZRjkAzMwyygFgZpZRddUuoByLFi2KVatWVbsMM7MzxnPPPfdGRCwuNq2kAJB0LfBnQC3w9Yj47wXTVwIPA/PTee6IiK2S6oH/BTQCg8BvRcS/pstcCjwEzAS2ptNGvCZ11apVbNu2rZSSzcwMkPTacNNG7QKSVAvcC1wHrAM2SVpXMNsXgc0RcTGwEfhK2v5pgIi4CLgG+GNJQ+v8KnALsCb9d22pG2RmZmNXyjmA9cDeiNgXEb3Ao8D1BfMEMC993AC0po/XAf8MEBGHgSNAo6QlwLyIeCb9q/8vgV8a05aYmVlZSgmAZUBz3vNc2pbvbuBGSTmS7pzb0vYXgesl1UlaDVwKrEiXz43ymgBIukXSNknb2traSijXzMxKUUoAqEhbYV/9JuChiFgObAAeSbt6HiD5cN8G/CnwfaC/xNdMGiPui4jGiGhcvLjoeQwzMzsNpZwEzpH81T5kOae6eIbcTNqHHxHPSJoBLEq7fT4/NJOk7wMvAx3p64z0mmZmNo5KOQJ4FlgjaXV6Vc9GYEvBPAeAqwEkrQVmAG2SZkmanbZfA/RHxK6IOAgclXSZJAG/BvxdZTbJzMxKMeoRQET0S7oVeILkEs8HImKnpHuAbRGxBbgd+Jqkz5N05dwUESHpLOAJSYNAC/Af8176s5y6DPSf0n9mZjZBdCZ9HXRjY2N4HIBNNs/ub6euRly8ckG1SzF7B0nPRURjsWn+KgizMbrjW9v57F89T9/AYLVLMSuLA8BsDN460c++N47xetdxtu44WO1yzMriADAbg12tXUTAtFpx//de5UzqUjVzAJiNQVNLJwCf/cB5bM91su21jipXZFY6B4DZGDS1dnLW3Ol85ufPZf6sadz/b69WuySzkjkAzMagqaWTC5c1MKu+jo+vX8kTu17nwJvd1S7LrCQOALPT1NM7wN7Db3HhsgYAfu3nVlEr8eD3fRRgZwYHgNlp2nWwi8GAC5cmX4R7TsMMPvLepWx+tpmu431Vrs5sdA4As9O0szU5ATx0BABw85WrOdY7wDd/1DzcYmaThgPA7DQ1tXTyrtn1LGmYcbLtwmUNrF+9kIe+v59+DwyzSc4BYHaadrR0ccGyBpLvMzzl5itX03Kkhyd2HqpSZWalcQCYnYbjfQO8fOgoFy2b945pH1x7Nu9+1yzu/96+KlRmVjoHgNlp2PP6UfoHgwuXNrxjWm2N+OTlq3j+wBGeP+CBYTZ5OQDMTkNTkRPA+W5oXMHcGXXc/z1fEmqTlwPA7DQ0tXTRMHMayxfMLDp99vRkYNjjTa+T6/DAMJucHABmpyEZATzvHSeA833i8lUAPPz9/RNTlFmZHABmZertH2TP60eL9v/nWzp/JtddeA6P/qiZt070T1B1ZqVzAJiV6eXDR+kdGBy2/z/fr7/vXI6e6Odvt3lgmE0+DgCzMg19BXQpAfAzK+Zz6bsX8ODT+xkY9L0CbHJxAJiVqamli7nT63j3wlklzX/zlas50N7Nk7s8MMwmFweAWZl2tHSybuk8amqGPwGc70Przmb5gpk84EtCbZJxAJiVoX9gkN0Hu0rq/hlSV1vDTZev4kf729meOzKO1ZmVxwFgVoZX2o5xon+Qi8oIAIBf/dkVzJnugWE2uTgAzMqw4+QJ4Hd+B9BI5s6Yxq/+7Ar+cftBXu88Ph6lmZXNAWBWhqaWTmbV17J60Zyyl73p8lUMRvDwM/srXpfZ6XAAmJVhZ2sn65bMo7bEE8D5ViycxYcvOIe/+eEBuns9MMyqzwFgVqKBwWBna3kngAv9+vtW09nTx7eey1WwMrPT4wAwK9Grbxyju3dgTAFwycoFvHfFfB54ej+DHhhmVeYAMCtR02meAM4niZuvXM2rbxzjqT2HK1Wa2WlxAJiVqKmlk+l1NZy3uPwTwPmuu/AcljTM4Ov/5ktCrbpKCgBJ10raI2mvpDuKTF8p6SlJP5a0XdKGtH2apIcl7ZC0W9Kdecv8lqQmSTslfa5ym2Q2PppaO1m7ZB51tWP7u2laOjDsmX1vsjO9sYxZNYz6TpZUC9wLXAesAzZJWlcw2xeBzRFxMbAR+ErafgMwPSIuAi4FfkPSKkkXAp8G1gPvBX5R0ppKbJDZeBgcDHa2dI2p+yffxvUrmVVfywPf21+R1zM7HaX8KbMe2BsR+yKiF3gUuL5gngCGfjMagNa89tmS6oCZQC/QBawFfhAR3RHRD/xf4GNj2hKzcXSgvZujJ/rLHgE8nIaZ07jh0uVsebGFw10eGGbVUUoALAPyv8w8l7bluxu4UVIO2ArclrY/BhwDDgIHgC9HRDvQBLxf0rskzQI2ACuKrVzSLZK2SdrW1tZW2laZVdjQCOALRrkJTDk+ecVq+geDR37wWsVe06wcpQRAsREvhdevbQIeiojlJB/mj0iqITl6GACWAquB2yWdGxG7gS8BTwKPAy8CRUfGRMR9EdEYEY2LFy8uZZvMKq6ptZP62hp+6uy5FXvNVYtm88G1Z/PID17jSHdvxV7XrFSlBECOt/91vpxTXTxDbgY2A0TEM8AMYBHwceDxiOiLiMPA00BjOt/9EXFJRLwfaAdeHsuGmI2nnS1dnH/OXOrrKnvh3G9f81N09fTxJ0/+pKKva1aKUt7NzwJrJK2WVE9ykndLwTwHgKsBJK0lCYC2tP0qJWYDlwEvpfOdlf6/Evhl4Btj3xyzyosIdqQ3ga+0tUvmceNl7+avfvAau1q7Kv76ZiMZNQDSk7S3Ak8Au0mu9tkp6R5JH01nux34tKQXST7Ib4qIILl6aA5Jn/+zwIMRsT1d5luSdgF/D/xmRHRUcsPMKiXX0UNnT19F+//z/fY1P8X8WfXcvWUnya+N2cSoK2WmiNhKcnI3v+2uvMe7gCuKLPcWyaWgxV7zfWVValYlQ9fqV+oKoELzZ9XzOx8+nzu/vYMtL7Zy/c8UXmNhNj48EthsFDtaOqmrEeefU7kTwIV+pXEFFy1r4L9t3c2xE/6mUJsYDgCzUTS1dLHm7LnMmFY7buuorRG/f/0FHOo6wZ8/tXfc1mOWzwFgNoKIoKmlkwuXVv4EcKFLVi7g31+ynK//2z5efePYuK/PzAFgNoLXu47z5rHeMX0FdDl+97rzmV5Xyz1/v3NC1mfZ5gAwG0FTS3Jp5kQFwFlzZ/C5D67hqT1t/PPuQxOyTssuB4DZCHa0dFIjWLtk/E4AF/rE5as476w53PMPuzjeNzBh67XscQCYjWBnSyfvWTyHWfUlXTFdEdNqa7j7Ixfw2pvd3P893zPAxo8DwGwETa2d43b9/0iuXLOIay84hz//l720HumZ8PVbNjgAzIZx+OhxDnWd4IIqBADAF35hLYMR/Netu6uyfpv6HABmw9iZngCuxhEAwIqFs/jsB97DP24/yPdfeaMqNdjU5gAwG8bQPQDWTcAYgOF85uffw/IFM/n9LbvoHxisWh02NTkAzIbR1NLJuYtmM2f6xJ0ALjRjWi1f/IV17Dl01DeOsYpzAJgNY2dr14Rd/z+SD19wNu9bs4g/efInvPHWiWqXY1OIA8CsiPZjvbQc6RmXewCUSxK/95EL6Okd4I8e31PtcmwKcQCYFdGU9v9PhiMAgPPOmsOnrlzN5ueaebH5SLXLsSnCAWBWxHjcBH6sbrvqPBbNmc5dW3YyOOgbx9jYOQDMitjZ2snKhbNomDmt2qWcNHfGNO687qd5sfkIjz2fq3Y5NgU4AMyKaGrpqtr1/yP52MXLuPTdC/jDx1+i63hftcuxM5wDwKxAZ3cfB9q7uWASnAAuJInf/+gFvHmslz998uVql2NnOAeAWYGhewBfOIn6//NduKyBTetX8vAz+/nJoaPVLsfOYNUb4WI2STW1Tq4rgIr5nQ+dzz9uP8gXvrODmy5fXe1ybJzV19VwzbqzK/66DgCzAjtaulg2fyYLZ9dXu5RhLZhdzx3X/TR3fnsHz+7vqHY5Ns4WzZnuADCbCDtbOifFALDRbFq/kivPW0SPbxoz5dXWaFxe1wFglufo8T72vXGMj128rNqllGTFwlnVLsHOYD4JbJZnV+vE3gPYrJocAGZ5mhwAliEOALM8TS2dnD1vOovnTq92KWbjzgFglqeppXPSXv9vVmkOALNUd28/r7S95e4fywwHgFlq98EuBsP9/5YdJQWApGsl7ZG0V9IdRaavlPSUpB9L2i5pQ9o+TdLDknZI2i3pzrxlPi9pp6QmSd+QNKNym2VWvqYq3wTebKKNGgCSaoF7geuAdcAmSesKZvsisDkiLgY2Al9J228ApkfERcClwG9IWiVpGfCfgcaIuBCoTZczq5odLZ0smlPP2fN8AtiyoZQjgPXA3ojYFxG9wKPA9QXzBDA0dLIBaM1rny2pDpgJ9AJd6bQ6YGY6bVbeMmZV0dTSyQVLG5DGZ9Sl2WRTSgAsA5rznufStnx3AzdKygFbgdvS9seAY8BB4ADw5Yhoj4gW4Mtp20GgMyK+W2zlkm6RtE3Stra2ttK2yqxMx/sGePnwW+7+sUwpJQCK/TlUeD+6TcBDEbEc2AA8IqmG5OhhAFgKrAZul3SupAUkRxGr02mzJd1YbOURcV9ENEZE4+LFi0vaKLNyvfT6UQYG44z4DiCzSiklAHLAirzny3lnd83NwGaAiHgGmAEsAj4OPB4RfRFxGHgaaAQ+CLwaEW0R0Qd8G7h8LBtiNhaT7SbwZhOhlAB4FlgjabWkepKTtVsK5jkAXA0gaS1JALSl7VcpMRu4DHgpbb9M0iwlHa5XA7srsUFmp2NnayfzZ01j2fyZ1S7FbMKM+m2gEdEv6VbgCZKrdR6IiJ2S7gG2RcQW4Hbga5I+T9I9dFNEhKR7gQeBJpKupAcjYjuApMeA54F+4MfAfZXfPLPS7EhHAPsEsGVJSV8HHRFbSU7u5rfdlfd4F3BFkeXeIrkUtNhr/h7we+UUazYe+gcG2fP6UT51he+sZdnikcCWea93HadvIFi1aHa1SzGbUA4Ay7xcRw8AKxb45iqWLQ4Ay7yhAFi+wCeALVscAJZ5ze3dSLDUVwBZxjgALPNyHT2cM28G9XX+dbBs8TveMq+5o9vdP5ZJDgDLvJaOHp8AtkxyAFim9Q0McrCzx0cAlkkOAMu0g0eOMxiw3EcAlkEOAMu0XEc3AMsX+gjAsscBYJnmQWCWZQ4Ay7Tmjm5qa8SSBt+S2rLHAWCZNjQGoK7WvwqWPX7XW6blPAbAMswBYJnW3N7DioXu/7dscgBYZp3oH+DQ0eM+ArDMcgBYZrUeOU54DIBlmAPAMmtoDMAKHwFYRjkALLNO3gfA5wAsoxwAllnN7d3U1Yhz5nkMgGWTA8AyK9fRw9L5M6mtUbVLMasKB4BllscAWNY5ACyzmn0fAMs4B4Bl0vG+AdqOnvARgGWaA8Ay6dQVQA4Ayy4HgGXSqTEA7gKy7HIAWCadPAJwAFiGOQAsk5o7uqmvreGsudOrXYpZ1TgALJNyHT0sWzCTGo8BsAxzAFgm5Tp6fAWQZV5JASDpWkl7JO2VdEeR6SslPSXpx5K2S9qQtk+T9LCkHZJ2S7ozbT9f0gt5/7okfa6ym2Y2vFx7t/v/LfPqRptBUi1wL3ANkAOelbQlInblzfZFYHNEfFXSOmArsAq4AZgeERdJmgXskvSNiNgD/Eze67cA36ngdpkNq7u3nzeP9foIwDKvlCOA9cDeiNgXEb3Ao8D1BfMEMC993AC05rXPllQHzAR6ga6CZa8GXomI106jfrOytZy8AsgBYNlWSgAsA5rznufStnx3AzdKypH89X9b2v4YcAw4CBwAvhwR7QXLbgS+MdzKJd0iaZukbW1tbSWUazay5qExAP4aaMu4UgKg2GUSUfB8E/BQRCwHNgCPSKohOXoYAJYCq4HbJZ178oWleuCjwN8Ot/KIuC8iGiOicfHixSWUazaynI8AzIDSAiAHrMh7vpxTXTxDbgY2A0TEM8AMYBHwceDxiOiLiMPA00Bj3nLXAc9HxKHTK9+sfM3t3Uyvq2HxHI8BsGwrJQCeBdZIWp3+xb4R2FIwzwGSvnwkrSUJgLa0/SolZgOXAS/lLbeJEbp/zMbD0CWgkscAWLaNGgAR0Q/cCjwB7Ca52menpHskfTSd7Xbg05JeJPlAvykiguTqoTlAE0mQPBgR2wHSq4KuAb5d4W0yG1ESAO7/Nxv1MlCAiNhKcnI3v+2uvMe7gCuKLPcWyaWgxV6zG3hXOcWaVUJzRzfvXdFQ7TLMqs4jgS1Tjh7v40h3n48AzHAAWMa0HPEVQGZDHACWKc3tSQD4PgBmDgDLmKEbwfgIwMwBYBmT6+hh5rRaFs6ur3YpZlXnALBMaW7vZsVCjwEwAweAZYzHAJid4gCwTGnu6GaF+//NAAeAZUhnTx9Hj/f7CMAs5QCwzPAVQGZv5wCwzDg5BsD3ATADHACWIT4CMHs7B4BlRq6jhznT62iYOa3apZhNCg4Ay4xcR7fvA2CWxwFgmeExAGZv5wCwTIiIk6OAzSzhALBMONLdx7HeAR8BmOVxAFgm5Dp8HwCzQg4Ay4Tm9BJQ3wfA7BQHgGXC0BiAZT4CMDvJAWCZkOvoYd4MjwEwy+cAsExIrgBy949ZPgeAZUIyBsDdP2b5HAA25UUEuY4enwA2K+AAsCnvzWO99PQN+AjArIADwKa8U2MAfARgls8BYFNec3s6BsAngc3exgFgU97QEYDHAJi9nQPAprxcRzcLZk1jzvS6apdiNqk4AGzKa+7ocfePWRElBYCkayXtkbRX0h1Fpq+U9JSkH0vaLmlD2j5N0sOSdkjaLenOvGXmS3pM0kvptJ+r3GaZnTJ0Ixgze7tRA0BSLXAvcB2wDtgkaV3BbF8ENkfExcBG4Ctp+w3A9Ii4CLgU+A1Jq9JpfwY8HhE/DbwX2D22TTF7p4igxWMAzIoq5QhgPbA3IvZFRC/wKHB9wTwBzEsfNwCtee2zJdUBM4FeoEvSPOD9wP0AEdEbEUfGtCVmRbQdPcGJ/kEfAZgVUUoALAOa857n0rZ8dwM3SsoBW4Hb0vbHgGPAQeAA8OWIaAfOBdqAB9Nuo69Lml1s5ZJukbRN0ra2trYSN8ss0ewxAGbDKiUAit1BOwqebwIeiojlwAbgEUk1JEcPA8BSYDVwu6RzgTrgEuCrabfRMeAd5xYAIuK+iGiMiMbFixeXsk1mJw19DbRvBWn2TqUEQA5Ykfd8Oae6eIbcDGwGiIhngBnAIuDjJP38fRFxGHgaaExfMxcRP0yXf4wkEMwq6uQYgPk+AjArVEoAPAuskbRaUj3JSd4tBfMcAK4GkLSWJADa0varlJgNXAa8FBGvA82Szk+XvxrYNeatMSuQ6+hm0Zx6ZtbXVrsUs0ln1JExEdEv6VbgCaAWeCAidkq6B9gWEVuA24GvSfo8SffQTRERku4FHgSaSLqSHoyI7elL3wb8dRoq+4BPVnrjzJrbe9z/bzaMkoZGRsRWkpO7+W135T3eBVxRZLm3SC4FLfaaL5B0B5mNm1xHNxcua6h2GWaTkkcC25Q1OBi0HPERgNlwHAA2ZR06epy+gfAVQGbDcADYlOX7AJiNzAFgU9bJMQAeBWxWlAPApqzm9uQIYOl8B4BZMQ4Am7JyHd2cNXc6M6Z5DIBZMQ4Am7Ka230fALOROABsysod8X0AzEbiALApqX9gkINHjjsAzEbgALAp6fWu4/QPhm8EYzYCB4BNSR4DYDY6B4BNSUMB4FHAZsNzANiU1NzejQRLGhwAZsNxANiUlOvo4Zx5M6iv81vcbDj+7bApqbmj2yeAzUbhALApqaWjx5eAmo3CAWBTTt/AIAc7HQBmo3EA2JRz8MhxBgOW+2sgzEbkALApZ+hroH0EYDYyB4BNOSfHAPgksNmIHAA25TR3dFNbI5Y0zKh2KWaTmgPAppyhMQB1tX57m43EvyE25eQ6uv0VEGYlcADYlNPc3uMvgTMrgQPAppQT/QMcOur7AJiVwgFgU0rrkeNE+Aogs1I4AGxK8RgAs9I5AGxKOXUfAB8BmI3GAWBTSnN7N3U14ux5HgNgNpqSAkDStZL2SNor6Y4i01dKekrSjyVtl7QhbZ8m6WFJOyTtlnRn3jL70/YXJG2r3CZZluU6elg6fya1Nap2KWaTXt1oM0iqBe4FrgFywLOStkTErrzZvghsjoivSloHbAVWATcA0yPiIkmzgF2SvhER+9Pl/l1EvFG5zbGs8xgAs9KVcgSwHtgbEfsiohd4FLi+YJ4A5qWPG4DWvPbZkuqAmUAv0DXmqs2G0dzRw/L57v83K0UpAbAMaM57nkvb8t0N3CgpR/LX/21p+2PAMeAgcAD4ckS0p9MC+K6k5yTdcnrlm51yvG+AtqMnfAWQWYlKCYBinalR8HwT8FBELAc2AI9IqiE5ehgAlgKrgdslnZsuc0VEXAJcB/ympPcXXbl0i6Rtkra1tbWVUK5lVcsRXwFkVo5SAiAHrMh7vpxTXTxDbgY2A0TEM8AMYBHwceDxiOiLiMPA00BjOl9r+v9h4DskYfEOEXFfRDRGROPixYtL3S7LoOZ2jwEwK0cpAfAssEbSakn1wEZgS8E8B4CrASStJQmAtrT9KiVmA5cBL0maLWluOv9s4ENAUyU2yLLLYwDMyjPqVUAR0S/pVuAJoBZ4ICJ2SroH2BYRW4Dbga9J+jxJ99BNERGS7gUeJPlwF/BgRGxPu4G+I2mohr+JiMfHYwMtO5o7uqmvrWHxnOnVLsXsjDBqAABExFaSk7v5bXflPd4FXFFkubdILgUtbN8HvLfcYs1GkuvoYdmCmdR4DIBZSTwS2KaMXEeP+//NyuAAsCkj197t+wCYlcEBYFNCd28/bx7r9RGAWRlKOgdwpvvI//wex/sGql2GjaP+wWRoiq8AMitdJgLgPYtn0zswWO0ybJxdvHI+V563qNplmJ0xMhEAf7rx4mqXYGY26fgcgJlZRjkAzMwyygFgZpZRDgAzs4xyAJiZZZQDwMwsoxwAZmYZ5QAwM8soRRTe3XHyktQGvHaaiy8C3qhgOZXiusrjusrjusozFet6d0QUvZ3iGRUAYyFpW0Q0VruOQq6rPK6rPK6rPFmry11AZmYZ5QAwM8uoLAXAfdUuYBiuqzyuqzyuqzyZqisz5wDMzOztsnQEYGZmeRwAZmYZNaUCQNINknZKGpTUWDDtTkl7Je2R9OFhll8t6YeSXpb0TUn141DjNyW9kP7bL+mFYebbL2lHOt+2StdRZH13S2rJq23DMPNdm+7DvZLumIC6/kjSS5K2S/qOpPnDzDch+2u07Zc0Pf0Z703fS6vGq5a8da6Q9JSk3en7/7eKzPMBSZ15P9+7xruudL0j/lyU+B/p/tou6ZIJqOn8vP3wgqQuSZ8rmGdC9pekByQdltSU17ZQ0pPp59CTkhYMs+wn0nlelvSJ0yogIqbMP2AtcD7wr0BjXvs64EVgOrAaeAWoLbL8ZmBj+vgvgM+Oc71/DNw1zLT9wKIJ3Hd3A/9llHlq0313LlCf7tN141zXh4C69PGXgC9Va3+Vsv3AfwL+In28EfjmBPzslgCXpI/nAj8pUtcHgH+YqPdTqT8XYAPwT4CAy4AfTnB9tcDrJIOlJnx/Ae8HLgGa8tr+ELgjfXxHsfc8sBDYl/6/IH28oNz1T6kjgIjYHRF7iky6Hng0Ik5ExKvAXmB9/gySBFwFPJY2PQz80njVmq7vV4BvjNc6xsF6YG9E7IuIXuBRkn07biLiuxHRnz79AbB8PNc3ilK2/3qS9w4k76Wr05/1uImIgxHxfPr4KLAbWDae66yg64G/jMQPgPmSlkzg+q8GXomI0/2GgTGJiP8HtBc057+Hhvsc+jDwZES0R0QH8CRwbbnrn1IBMIJlQHPe8xzv/AV5F3Ak78Om2DyV9D7gUES8PMz0AL4r6TlJt4xjHfluTQ/DHxjmsLOU/TiePkXy12IxE7G/Stn+k/Ok76VOkvfWhEi7nC4Gflhk8s9JelHSP0m6YIJKGu3nUu331EaG/yOsGvsL4OyIOAhJuANnFZmnIvvtjLspvKT/A5xTZNIXIuLvhlusSFvh9a+lzFOSEmvcxMh//V8REa2SzgKelPRS+tfCaRupLuCrwB+QbPMfkHRPfarwJYosO+briEvZX5K+APQDfz3My1R8fxUrtUjbuL2PyiVpDvAt4HMR0VUw+XmSbo630vM7/xtYMwFljfZzqeb+qgc+CtxZZHK19lepKrLfzrgAiIgPnsZiOWBF3vPlQGvBPG+QHH7WpX+5FZunIjVKqgN+Gbh0hNdoTf8/LOk7JN0PY/pAK3XfSfoa8A9FJpWyHyteV3qC6xeBqyPtAC3yGhXfX0WUsv1D8+TSn3MD7zzErzhJ00g+/P86Ir5dOD0/ECJiq6SvSFoUEeP6xWcl/FzG5T1VouuA5yPiUOGEau2v1CFJSyLiYNoddrjIPDmS8xRDlpOc+yxLVrqAtgAb0ys0VpMk+Y/yZ0g/WJ4C/kPa9AlguCOKsfog8FJE5IpNlDRb0tyhxyQnQpuKzVspBf2uHxtmfc8Ca5RcLVVPcvi8ZZzruhb4XeCjEdE9zDwTtb9K2f4tJO8dSN5L/zJcaFVKeo7hfmB3RPzJMPOcM3QuQtJ6kt/9N8e5rlJ+LluAX0uvBroM6Bzq/pgAwx6FV2N/5cl/Dw33OfQE8CFJC9Lu2g+lbeUZ77PcE/mP5IMrB5wADgFP5E37AskVHPLnFqIAAADxSURBVHuA6/LatwJL08fnkgTDXuBvgenjVOdDwGcK2pYCW/PqeDH9t5OkK2S8990jwA5ge/oGXFJYV/p8A8lVJq9MUF17Sfo6X0j//UVhXRO5v4ptP3APSUABzEjfO3vT99K5E7CPriQ5/N+et582AJ8Zep8Bt6b75kWSk+mXT0BdRX8uBXUJuDfdnzvIu3pvnGubRfKB3pDXNuH7iySADgJ96WfXzSTnjP4ZeDn9f2E6byPw9bxlP5W+z/YCnzyd9furIMzMMiorXUBmZlbAAWBmllEOADOzjHIAmJlllAPAzCyjHABmZhnlADAzy6j/Dx6RokybwU4FAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Our optimal C is 1.000000\n",
      "Our accuracy at optimal C is 0.889848\n"
     ]
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline\n",
    "# Try testing and plot\n",
    "c_list = np.logspace(-10,10,21) \n",
    "c_index = np.linspace(-10,10,21)\n",
    "#C is just the inverse of Lambda - the smaller the C - the stronger the\n",
    "#regulatization. The smaller C's choose less variables\n",
    "cv_scores = []\n",
    "for c_score in c_list:\n",
    "    lm = LogisticRegression(C = c_score,  solver = 'liblinear', max_iter  = 50000, penalty = 'l1')\n",
    "    cv_scores.append(cross_val_score(lm, X, y,cv = 10, scoring = 'accuracy').mean())\n",
    "\n",
    "plt.plot(c_index, cv_scores)\n",
    "plt.show()\n",
    "\n",
    "print(\"Our optimal C is %f\" %c_list[np.argmax(cv_scores)])   \n",
    "print(\"Our accuracy at optimal C is %f\" %np.max(cv_scores))\n",
    "    "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Localize your search around the value you found above"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Our optimal C is 0.257576\n",
      "Our accuracy at optimal C is 0.890513\n"
     ]
    }
   ],
   "source": [
    "### You can localize your search once you have an idea of where to search for the optimal solution\n",
    "\n",
    "c_list = np.linspace(0.1,4,100) \n",
    "cv_scores = []\n",
    "for c_score in c_list:\n",
    "    lm = LogisticRegression(C = c_score,  solver = 'liblinear', max_iter  = 50000, penalty = 'l1')\n",
    "    cv_scores.append(cross_val_score(lm, X, y,cv = 10, scoring = 'accuracy').mean())\n",
    "\n",
    "plt.plot(c_list, cv_scores)\n",
    "plt.show()\n",
    "\n",
    "print(\"Our optimal C is %f\" %c_list[np.argmax(cv_scores)])   \n",
    "print(\"Our accuracy at optimal C is %f\" %np.max(cv_scores))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Now use the best C you found above and repeat your analysis and check your coefficients"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[ 0.0407836   0.         10.06346145 -0.1541375   2.81585963  0.15391273\n",
      "   0.         -0.8132101  -0.74469598]]\n"
     ]
    }
   ],
   "source": [
    "lm = LogisticRegression(C = 0.257576,  solver = 'liblinear', max_iter  = 50000, penalty = 'l1')\n",
    "lm.fit(X,y)\n",
    "print(lm.coef_)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### If you would like to drop 2 variables from your analysis, which variables are you going to choose?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Answer: We can drop 'balance' and 'default_yes'. We can see that they are shrunk to zero."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Compare the results you found out above with p-values of statsmodels api. Do you have same story there? "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "Answer: "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can see the z score from Statsmodel, both balance and default_yes are close to zero."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
